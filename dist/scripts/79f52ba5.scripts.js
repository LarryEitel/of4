(function(){"use strict";angular.module("of4App",[]).config(["$routeProvider",function(t){return t.when("/menu",{templateUrl:"views/menu.html",controller:"MainCtrl"}).when("/list",{templateUrl:"views/list.html",controller:"MainCtrl"}).when("/map",{templateUrl:"views/map.html",controller:"MainCtrl"}).when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({templateUrl:"views/main.html",controller:"MainCtrl"})}]).run(["$rootScope","$location",function(t,o){var e;return e=t,e.navBarHeight=40,e.mapShownOnce=!1,e.mapShown=function(){var t;return t=o.path().indexOf("/map")>-1,t&&!e.mapShownOnce&&(e.mapShownOnce=!0),t}}])}).call(this),function(){"use strict";angular.module("of4App").controller("MainCtrl",["$scope","GoogleMap",function(t,o){return o.win[0].google.maps.event.trigger(map,"resize"),t.map=o}])}.call(this),function(){"use strict";angular.module("of4App").controller("MapCtrl",["$scope",function(){}])}.call(this),function(){"use strict";var t,o,e=function(t,o){return function(){return t.apply(o,arguments)}};o=function(){function t(t,o,i){this.map=t,this.lat=o,this.lng=i,this.move=e(this.move,this),this.show=e(this.show,this),this.dragend=e(this.dragend,this),this.position=new google.maps.LatLng(this.lat,this.lng),this.render()}return t.prototype.render=function(){return this.marker=new google.maps.Marker({draggable:!0}),google.maps.event.addListener(this.marker,"dragend",this.dragend),google.maps.event.addListener(this.marker,"click",this.click),this.show()},t.prototype.dragend=function(){confirm("Are you sure you want to move this marker?")},t.prototype.show=function(){return this.marker.setPosition(this.position),this.marker.setMap(this.map)},t.prototype.move=function(t){return console.log("move"),t.preventDefault(),alert("move")},t}(),t=function(){function t(t){this.onTypeChange=e(this.onTypeChange,this),this.onZoomChange=e(this.onZoomChange,this),this.onCenterChanged=e(this.onCenterChanged,this),this.resizeMapEl=e(this.resizeMapEl,this),this.onDragEnd=e(this.onDragEnd,this),this.onDragStart=e(this.onDragStart,this),this.onPositionButtonClick=e(this.onPositionButtonClick,this),this.addPlace=e(this.addPlace,this),this.getDirections=e(this.getDirections,this);var o,i,n,a,s;this.rootScope=t.rootScope,this.dragging=0,this.location=t.location,this.positionTracking=!1,s=this.location.search().q,s?(n=s.split(","),i=n[0],a=n[1],this.center={lat:i,lng:a}):this.center=t.center,this.zoom=parseInt(this.location.search().z)||t.zoom,this.mapType=this.location.search().t||t.mapType,this.navBarHeight=this.rootScope.navBarHeight,this.win=$(window),this.crossHairLatEl=$("#mapcrosshairlat"),this.crossHairLngEl=$("#mapcrosshairlng"),this.mapEl=$("#map"),this.mapTypes={m:"roadmap",h:"hybrid"},{mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:google.maps.ControlPosition.TOP_RIGHT,mapTypeIds:[google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.HYBRID]},panControl:!1,panControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT},streetViewControl:!1,streetViewControlOptions:{position:google.maps.ControlPosition.LEFT_TOP},zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.LARGE,position:google.maps.ControlPosition.LEFT_TOP}},this.mapEl.hide(),this.resizeMapEl(),this.win.resize(this.resizeMapEl),$("#map-position-button").click(this.onPositionButtonClick),$("#map-add-button").click(this.addPlace),$("#map-directions-button").click(this.getDirections),this.map=new google.maps.Map(this.mapEl[0],{zoom:this.zoom,center:new google.maps.LatLng(this.center.lat,this.center.lng),mapTypeId:this.mapTypes[this.mapType]}),o=google.maps.event.addListener,o(this.map,"center_changed",this.onCenterChanged),o(this.map,"maptypeid_changed",this.onTypeChange),o(this.map,"zoom_changed",this.onZoomChange),o(this.map,"dragstart",this.onDragStart),o(this.map,"dragend",this.onDragEnd),this.rootScope.protocol=this.location.protocol(),this.rootScope.host=this.location.host(),this.rootScope.mapCenter=this.center,this.rootScope.mapZoom=this.zoom,this.rootScope.mapType=this.mapType}var i,n;return t.prototype.getDirections=function(){return console.log("getDirections")},t.prototype.addPlace=function(){var t,e,i;return t=this.map.getCenter().lat(),e=this.map.getCenter().lng(),i=new o(this.map,t,e)},t.prototype.onPositionButtonClick=function(){return this.positionTracking.state?this.positionTracking.state?this.cancelPositionTracking():void 0:(this.positionTrackingOn(),this.positionTrackGoTo())},t.prototype.positionTrackingOn=function(){var t,o,e;if(this.nav||(this.nav=window.navigator),this.nav){t=this.nav.geolocation,window.map=this.map,t&&(e=t.watchPosition(i,n,o={enableHighAccuracy:!0}));try{t.getCurrentPosition(i,n,o={enableHighAccuracy:!0})}catch(a){}return this.positionTracking.state=!0}},t.prototype.positionTrackGoTo=function(){var t;return t=window.pos,t?this.map.setCenter(new google.maps.LatLng(t.lat(),t.lng())):void 0},t.prototype.cancelPositionTracking=function(t){window.navigator.geolocation.clearWatch(t);try{window.userPositionMarker.setMap(null)}catch(o){}return this.positionTracking.state=!1},i=function(t){var o,e;if(t.coords.latitude){window.pos=new google.maps.LatLng(t.coords.latitude,t.coords.longitude);try{window.userPositionMarker.setMap(null)}catch(i){}return o="images/blue-dot.png",e=new google.maps.MarkerImage(o,new google.maps.Size(16,16),new google.maps.Point(0,0),new google.maps.Point(8,3)),window.userPositionMarker=new google.maps.Marker({icon:e,position:window.pos,map:window.map,title:"You are here."})}},n=function(t){var o,e;switch(console.log("geoLoc error"),e="Unable to locate position. ",t.code){case t.TIMEOUT:e+="Timeout.";break;case t.POSITION_UNAVAILABLE:e+="Position unavailable.";break;case t.PERMISSION_DENIED:e+="Please turn on location services.";break;case t.UNKNOWN_ERROR:e+=t.code}return $(".alert-message").remove(),o=$('<div class="alert-message error fade in" data-alert="alert">'),o.html('<a class="close" href="#">Ã—</a>'+e),o.insertBefore($(".span10"))},t.prototype.updateLocation=function(){return"/map"===this.location.path()?this.location.url("#/map?q="+this.center.lat+","+this.center.lng+"&t="+this.mapType+"&z="+this.zoom):void 0},t.prototype.onDragStart=function(){return this.dragging=!0},t.prototype.onDragEnd=function(){return this.dragging=!1,this.onCenterChanged()},t.prototype.resizeMapEl=function(){return this.mapEl.css("height",this.win.height()-this.navBarHeight)},t.prototype.onCenterChanged=function(){var t;return t=this.map.getCenter(),this.center.lat=t.lat(),this.center.lng=t.lng(),this.crossHairLatEl.html(this.center.lat),this.crossHairLngEl.html(this.center.lng),this.dragging?void 0:(this.rootScope.mapCenter=this.center,this.rootScope.$apply(),this.updateLocation())},t.prototype.onZoomChange=function(){return this.rootScope.mapZoom=this.zoom=this.map.getZoom(),this.rootScope.$apply(),this.updateLocation()},t.prototype.onTypeChange=function(){switch(this.mapType=this.map.getMapTypeId(),this.map.getMapTypeId()){case google.maps.MapTypeId.ROADMAP:case google.maps.MapTypeId.HYBRID:this.polyOpts=!0;break;default:this.polyOpts=!0}return this.rootScope.mapType=this.mapType[0],this.rootScope.$apply(),this.updateLocation()},t}.call(this),angular.module("of4App").factory("GoogleMap",["$rootScope","$location",function(o,e){var i,n,a,s;return i={lat:9.993552791991132,lng:-84.20888416469096},n=i,a=16,s={rootScope:o,location:e,zoom:a,mapType:"m",center:{lat:n.lat,lng:n.lng}},new t(s)}])}.call(this);